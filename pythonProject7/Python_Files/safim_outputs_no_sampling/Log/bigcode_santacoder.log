2025-06-13 21:42:22,022 - INFO - backup_safim2.py:480 - Log file will be saved to: ./safim_outputs/Log/bigcode_santacoder.log
2025-06-13 21:42:22,022 - INFO - backup_safim2.py:481 - Results file will be saved to: ./safim_outputs/Results/bigcode_santacoder.jsonl
2025-06-13 21:42:22,023 - INFO - backup_safim2.py:482 - Summary file will be saved to: ./safim_outputs/Summary/bigcode_santacoder_summary.txt
2025-06-13 21:42:22,023 - INFO - backup_safim2.py:498 - Using default post-processors for 'block': ['truncate_line_until_block']
2025-06-13 21:42:22,110 - INFO - backup_safim2.py:506 - Loaded cache with 3875 entries from ./model_cache.json.
2025-06-13 21:42:22,110 - INFO - backup_safim2.py:511 - Building model: bigcode/santacoder
2025-06-13 21:42:22,115 - DEBUG - connectionpool.py:1022 - Starting new HTTPS connection (1): huggingface.co:443
2025-06-13 21:42:22,265 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /bigcode/santacoder/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-06-13 21:42:22,275 - DEBUG - _api.py:254 - Attempting to acquire lock 127520587651216 on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/e475537cea8dae07660e1e6fc7123fe1d2dcc2b4.lock
2025-06-13 21:42:22,276 - DEBUG - _api.py:257 - Lock 127520587651216 acquired on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/e475537cea8dae07660e1e6fc7123fe1d2dcc2b4.lock
2025-06-13 21:42:22,399 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "GET /bigcode/santacoder/resolve/main/tokenizer_config.json HTTP/1.1" 200 159
2025-06-13 21:42:22,410 - DEBUG - _api.py:286 - Attempting to release lock 127520587651216 on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/e475537cea8dae07660e1e6fc7123fe1d2dcc2b4.lock
2025-06-13 21:42:22,411 - DEBUG - _api.py:289 - Lock 127520587651216 released on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/e475537cea8dae07660e1e6fc7123fe1d2dcc2b4.lock
2025-06-13 21:42:22,564 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "GET /api/models/bigcode/santacoder/tree/main/additional_chat_templates?recursive=False&expand=False HTTP/1.1" 404 64
2025-06-13 21:42:22,684 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /bigcode/santacoder/resolve/main/vocab.json HTTP/1.1" 404 0
2025-06-13 21:42:22,807 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /bigcode/santacoder/resolve/main/merges.txt HTTP/1.1" 404 0
2025-06-13 21:42:22,941 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /bigcode/santacoder/resolve/main/tokenizer.json HTTP/1.1" 200 0
2025-06-13 21:42:22,944 - DEBUG - _api.py:254 - Attempting to acquire lock 127520565068432 on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/c0e0c5c6002b5ebead66bc3063d6385533e42792.lock
2025-06-13 21:42:22,945 - DEBUG - _api.py:257 - Lock 127520565068432 acquired on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/c0e0c5c6002b5ebead66bc3063d6385533e42792.lock
2025-06-13 21:42:23,076 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "GET /bigcode/santacoder/resolve/main/tokenizer.json HTTP/1.1" 200 2081116
2025-06-13 21:42:23,458 - DEBUG - _api.py:286 - Attempting to release lock 127520565068432 on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/c0e0c5c6002b5ebead66bc3063d6385533e42792.lock
2025-06-13 21:42:23,458 - DEBUG - _api.py:289 - Lock 127520565068432 released on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/c0e0c5c6002b5ebead66bc3063d6385533e42792.lock
2025-06-13 21:42:23,580 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /bigcode/santacoder/resolve/main/added_tokens.json HTTP/1.1" 404 0
2025-06-13 21:42:23,703 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /bigcode/santacoder/resolve/main/special_tokens_map.json HTTP/1.1" 200 0
2025-06-13 21:42:23,706 - DEBUG - _api.py:254 - Attempting to acquire lock 127520611094864 on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/01f7489191489baeadd5c226a8cdaef0800c72ca.lock
2025-06-13 21:42:23,707 - DEBUG - _api.py:257 - Lock 127520611094864 acquired on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/01f7489191489baeadd5c226a8cdaef0800c72ca.lock
2025-06-13 21:42:23,826 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "GET /bigcode/santacoder/resolve/main/special_tokens_map.json HTTP/1.1" 200 138
2025-06-13 21:42:23,831 - DEBUG - _api.py:286 - Attempting to release lock 127520611094864 on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/01f7489191489baeadd5c226a8cdaef0800c72ca.lock
2025-06-13 21:42:23,831 - DEBUG - _api.py:289 - Lock 127520611094864 released on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/01f7489191489baeadd5c226a8cdaef0800c72ca.lock
2025-06-13 21:42:24,068 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /bigcode/santacoder/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-06-13 21:42:24,360 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /bigcode/santacoder/resolve/main/config.json HTTP/1.1" 200 0
2025-06-13 21:42:24,364 - DEBUG - _api.py:254 - Attempting to acquire lock 127520564979664 on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/4eb239e0bea807d846571fd806c3f98153122266.lock
2025-06-13 21:42:24,365 - DEBUG - _api.py:257 - Lock 127520564979664 acquired on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/4eb239e0bea807d846571fd806c3f98153122266.lock
2025-06-13 21:42:24,489 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "GET /bigcode/santacoder/resolve/main/config.json HTTP/1.1" 200 948
2025-06-13 21:42:24,494 - DEBUG - _api.py:286 - Attempting to release lock 127520564979664 on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/4eb239e0bea807d846571fd806c3f98153122266.lock
2025-06-13 21:42:24,494 - DEBUG - _api.py:289 - Lock 127520564979664 released on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/4eb239e0bea807d846571fd806c3f98153122266.lock
2025-06-13 21:42:24,652 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /bigcode/santacoder/resolve/main/configuration_gpt2_mq.py HTTP/1.1" 200 0
2025-06-13 21:42:24,655 - DEBUG - _api.py:254 - Attempting to acquire lock 127520564510160 on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/e277bf406121191252d205d8ef3d775c30027da2.lock
2025-06-13 21:42:24,656 - DEBUG - _api.py:257 - Lock 127520564510160 acquired on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/e277bf406121191252d205d8ef3d775c30027da2.lock
2025-06-13 21:42:24,789 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "GET /bigcode/santacoder/resolve/main/configuration_gpt2_mq.py HTTP/1.1" 200 9474
2025-06-13 21:42:24,794 - DEBUG - _api.py:286 - Attempting to release lock 127520564510160 on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/e277bf406121191252d205d8ef3d775c30027da2.lock
2025-06-13 21:42:24,794 - DEBUG - _api.py:289 - Lock 127520564510160 released on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/e277bf406121191252d205d8ef3d775c30027da2.lock
2025-06-13 21:42:25,570 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /bigcode/santacoder/resolve/main/modeling_gpt2_mq.py HTTP/1.1" 200 0
2025-06-13 21:42:25,574 - DEBUG - _api.py:254 - Attempting to acquire lock 127520600946704 on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/c68565626213bdf735c314e938fb31c2ab0944ec.lock
2025-06-13 21:42:25,575 - DEBUG - _api.py:257 - Lock 127520600946704 acquired on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/c68565626213bdf735c314e938fb31c2ab0944ec.lock
2025-06-13 21:42:25,701 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "GET /bigcode/santacoder/resolve/main/modeling_gpt2_mq.py HTTP/1.1" 200 15132
2025-06-13 21:42:25,706 - DEBUG - _api.py:286 - Attempting to release lock 127520600946704 on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/c68565626213bdf735c314e938fb31c2ab0944ec.lock
2025-06-13 21:42:25,707 - DEBUG - _api.py:289 - Lock 127520600946704 released on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/c68565626213bdf735c314e938fb31c2ab0944ec.lock
2025-06-13 21:42:27,989 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /bigcode/santacoder/resolve/main/model.safetensors HTTP/1.1" 404 0
2025-06-13 21:42:28,118 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /bigcode/santacoder/resolve/main/model.safetensors.index.json HTTP/1.1" 404 0
2025-06-13 21:42:28,244 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /bigcode/santacoder/resolve/main/pytorch_model.bin HTTP/1.1" 302 0
2025-06-13 21:42:28,250 - DEBUG - _api.py:254 - Attempting to acquire lock 127520599234064 on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/b23b40393c323f7a5ee4b24d2f7311da42eaa2518ef5c9b4973a8f6f564a3f94.lock
2025-06-13 21:42:28,251 - DEBUG - _api.py:257 - Lock 127520599234064 acquired on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/b23b40393c323f7a5ee4b24d2f7311da42eaa2518ef5c9b4973a8f6f564a3f94.lock
2025-06-13 21:42:28,257 - DEBUG - connectionpool.py:1022 - Starting new HTTPS connection (1): cdn-lfs.hf.co:443
2025-06-13 21:42:28,423 - DEBUG - connectionpool.py:475 - https://cdn-lfs.hf.co:443 "GET /repos/a9/53/a9530d2bf661e3e0b95dc20b00917b811e52effad6302b5aef653de141aef414/b23b40393c323f7a5ee4b24d2f7311da42eaa2518ef5c9b4973a8f6f564a3f94?response-content-disposition=inline%3B+filename*%3DUTF-8%27%27pytorch_model.bin%3B+filename%3D%22pytorch_model.bin%22%3B&response-content-type=application%2Foctet-stream&Expires=1749847348&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTc0OTg0NzM0OH19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2RuLWxmcy5oZi5jby9yZXBvcy9hOS81My9hOTUzMGQyYmY2NjFlM2UwYjk1ZGMyMGIwMDkxN2I4MTFlNTJlZmZhZDYzMDJiNWFlZjY1M2RlMTQxYWVmNDE0L2IyM2I0MDM5M2MzMjNmN2E1ZWU0YjI0ZDJmNzMxMWRhNDJlYWEyNTE4ZWY1YzliNDk3M2E4ZjZmNTY0YTNmOTQ~cmVzcG9uc2UtY29udGVudC1kaXNwb3NpdGlvbj0qJnJlc3BvbnNlLWNvbnRlbnQtdHlwZT0qIn1dfQ__&Signature=mgPq9NuYRqJfRdKATvV2L05WVPeyL0MIvoXmyQ-gZ3KaezvanbmnvyS1sq12ptAN46P0qXpHiSMzhy0kn~fkx10saFSqNi6HwkhCc0i7T3s4-7HsEqlSAng0EMlKskUZN6j9guPDI5hMMSm9G86wTEfMbjdZ~eqttixjxvwRK3oJ2oDE8IQFx9Ex5eSIMkpFPX~kYNVhx9oUpdtpATd32qkcpQ9yUb3OsA8uBTgZw6cD7JfFD~9-1xYAMkYSplfGUUUZTppk5hFlh8MB3btr01D4qDTvA1nj3LUrJApmGSOIp~A4ANtOITjYmO1ToqLzrHczBRv3K-Vm-XxduHKiSg__&Key-Pair-Id=K3RPWS32NSSJCE HTTP/1.1" 200 4600328417
2025-06-13 21:51:59,258 - DEBUG - _api.py:286 - Attempting to release lock 127520599234064 on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/b23b40393c323f7a5ee4b24d2f7311da42eaa2518ef5c9b4973a8f6f564a3f94.lock
2025-06-13 21:51:59,260 - DEBUG - _api.py:289 - Lock 127520599234064 released on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/b23b40393c323f7a5ee4b24d2f7311da42eaa2518ef5c9b4973a8f6f564a3f94.lock
2025-06-13 21:51:59,267 - DEBUG - connectionpool.py:291 - Resetting dropped connection: huggingface.co
2025-06-13 21:51:59,275 - DEBUG - connectionpool.py:1022 - Starting new HTTPS connection (2): huggingface.co:443
2025-06-13 21:51:59,449 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /bigcode/santacoder/resolve/main/model.safetensors HTTP/1.1" 404 0
2025-06-13 21:51:59,454 - DEBUG - connectionpool.py:1022 - Starting new HTTPS connection (1): huggingface.co:443
2025-06-13 21:51:59,618 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "GET /api/models/bigcode/santacoder HTTP/1.1" 200 9922
2025-06-13 21:51:59,808 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "GET /api/models/bigcode/santacoder/commits/main HTTP/1.1" 200 16116
2025-06-13 21:51:59,975 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "GET /api/models/bigcode/santacoder/commits/main?p=1 HTTP/1.1" 200 1327
2025-06-13 21:52:00,530 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "GET /api/models/bigcode/santacoder/discussions?p=0 HTTP/1.1" 200 27838
2025-06-13 21:52:00,910 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "GET /api/models/bigcode/santacoder/commits/refs%2Fpr%2F45 HTTP/1.1" 200 16869
2025-06-13 21:52:01,074 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "GET /api/models/bigcode/santacoder/commits/refs%2Fpr%2F45?p=1 HTTP/1.1" 200 1539
2025-06-13 21:52:01,201 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /bigcode/santacoder/resolve/refs%2Fpr%2F45/model.safetensors.index.json HTTP/1.1" 404 0
2025-06-13 21:52:01,334 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /bigcode/santacoder/resolve/refs%2Fpr%2F45/model.safetensors HTTP/1.1" 302 0
2025-06-13 21:52:01,351 - DEBUG - _api.py:254 - Attempting to acquire lock 127520284325200 on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/358772c6256487ed5b828fd3028f28ed5666075dcbf5afd9a200697a25be1dec.lock
2025-06-13 21:52:01,355 - DEBUG - _api.py:257 - Lock 127520284325200 acquired on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/358772c6256487ed5b828fd3028f28ed5666075dcbf5afd9a200697a25be1dec.lock
2025-06-13 21:52:01,410 - DEBUG - connectionpool.py:1022 - Starting new HTTPS connection (1): cdn-lfs.hf.co:443
2025-06-13 21:52:01,585 - DEBUG - connectionpool.py:475 - https://cdn-lfs.hf.co:443 "GET /repos/a9/53/a9530d2bf661e3e0b95dc20b00917b811e52effad6302b5aef653de141aef414/358772c6256487ed5b828fd3028f28ed5666075dcbf5afd9a200697a25be1dec?response-content-disposition=inline%3B+filename*%3DUTF-8%27%27model.safetensors%3B+filename%3D%22model.safetensors%22%3B&Expires=1749847921&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTc0OTg0NzkyMX19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2RuLWxmcy5oZi5jby9yZXBvcy9hOS81My9hOTUzMGQyYmY2NjFlM2UwYjk1ZGMyMGIwMDkxN2I4MTFlNTJlZmZhZDYzMDJiNWFlZjY1M2RlMTQxYWVmNDE0LzM1ODc3MmM2MjU2NDg3ZWQ1YjgyOGZkMzAyOGYyOGVkNTY2NjA3NWRjYmY1YWZkOWEyMDA2OTdhMjViZTFkZWM~cmVzcG9uc2UtY29udGVudC1kaXNwb3NpdGlvbj0qIn1dfQ__&Signature=NnhXn3jTIdsRFpDUrS-Kp2atrjqTO04jTSC462VDFZA40~dTKxzTLyNWx~~zO-phnPiy7rklkcAvoZTwlbp7g6JY0aQzutFuNqZQgF6fte0cu-Pn0og2DtFpwlJEvbNRcTj6VMdh1GH2eTYHNG6W2TLeGIp~sbpQuWjsrFxv4y54~xUGI6YhtgLh1wjxRQUx47iBjPutC9Y31WdHKZDjlhglk16qMKvtxIBzvUoO51w7aChjmK4AvKXhEQo7AXGIAtwj0Xn6ZRnGGHlvlmQRG5IFKMN~VPMJA46WY~pIel1EtdFuRBW3NA7Jcr-vIu4mEmPnuwnW7-9YyioyKnRx4w__&Key-Pair-Id=K3RPWS32NSSJCE HTTP/1.1" 200 4600250392
2025-06-13 21:52:07,809 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /bigcode/santacoder/resolve/main/generation_config.json HTTP/1.1" 404 0
2025-06-13 21:52:07,939 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /bigcode/santacoder/resolve/main/custom_generate/generate.py HTTP/1.1" 404 0
2025-06-13 21:52:09,278 - INFO - backup_safim2.py:515 - Loading dataset: block
2025-06-13 21:52:09,403 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "GET /api/datasets/gonglinyuan/safim HTTP/1.1" 200 2256
2025-06-13 21:52:09,405 - DEBUG - connectionpool.py:1022 - Starting new HTTPS connection (1): s3.amazonaws.com:443
2025-06-13 21:52:09,787 - DEBUG - connectionpool.py:475 - https://s3.amazonaws.com:443 "HEAD /datasets.huggingface.co/datasets/datasets/gonglinyuan/safim/gonglinyuan/safim.py HTTP/1.1" 404 0
2025-06-13 21:52:09,912 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "GET /api/datasets/gonglinyuan/safim HTTP/1.1" 200 2256
2025-06-13 21:52:09,919 - DEBUG - connectionpool.py:1022 - Starting new HTTPS connection (1): huggingface.co:443
2025-06-13 21:52:10,087 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /datasets/gonglinyuan/safim/resolve/be132cc15372e90b6f03a608e77f2d940e384edb/README.md HTTP/1.1" 200 0
2025-06-13 21:52:10,105 - DEBUG - connectionpool.py:1022 - Starting new HTTPS connection (1): huggingface.co:443
2025-06-13 21:52:10,266 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /datasets/gonglinyuan/safim/resolve/be132cc15372e90b6f03a608e77f2d940e384edb/.huggingface.yaml HTTP/1.1" 404 0
2025-06-13 21:52:10,387 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "GET /api/datasets/gonglinyuan/safim/revision/be132cc15372e90b6f03a608e77f2d940e384edb HTTP/1.1" 200 2256
2025-06-13 21:52:10,512 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "GET /api/datasets/gonglinyuan/safim/tree/be132cc15372e90b6f03a608e77f2d940e384edb?recursive=False&expand=False HTTP/1.1" 200 1350
2025-06-13 21:52:10,518 - DEBUG - connectionpool.py:1022 - Starting new HTTPS connection (1): huggingface.co:443
2025-06-13 21:52:11,123 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "GET /api/datasets/gonglinyuan/safim/revision/be132cc15372e90b6f03a608e77f2d940e384edb HTTP/1.1" 200 2256
2025-06-13 21:52:11,129 - DEBUG - connectionpool.py:1022 - Starting new HTTPS connection (1): huggingface.co:443
2025-06-13 21:52:11,286 - DEBUG - connectionpool.py:475 - https://huggingface.co:443 "HEAD /datasets/gonglinyuan/safim/resolve/be132cc15372e90b6f03a608e77f2d940e384edb/dataset_infos.json HTTP/1.1" 404 0
2025-06-13 21:52:11,294 - DEBUG - _api.py:254 - Attempting to acquire lock 127520535513680 on /ceph/ssd/students/hifl/hf_cache/datasets/_ceph_ssd_students_hifl_hf_cache_datasets_gonglinyuan___safim_block_0.0.0_be132cc15372e90b6f03a608e77f2d940e384edb.lock
2025-06-13 21:52:11,295 - DEBUG - _api.py:257 - Lock 127520535513680 acquired on /ceph/ssd/students/hifl/hf_cache/datasets/_ceph_ssd_students_hifl_hf_cache_datasets_gonglinyuan___safim_block_0.0.0_be132cc15372e90b6f03a608e77f2d940e384edb.lock
2025-06-13 21:52:11,297 - DEBUG - local.py:298 - open file: /ceph/ssd/students/hifl/hf_cache/datasets/gonglinyuan___safim/block/0.0.0/be132cc15372e90b6f03a608e77f2d940e384edb/dataset_info.json
2025-06-13 21:52:11,298 - DEBUG - _api.py:286 - Attempting to release lock 127520535513680 on /ceph/ssd/students/hifl/hf_cache/datasets/_ceph_ssd_students_hifl_hf_cache_datasets_gonglinyuan___safim_block_0.0.0_be132cc15372e90b6f03a608e77f2d940e384edb.lock
2025-06-13 21:52:11,298 - DEBUG - _api.py:289 - Lock 127520535513680 released on /ceph/ssd/students/hifl/hf_cache/datasets/_ceph_ssd_students_hifl_hf_cache_datasets_gonglinyuan___safim_block_0.0.0_be132cc15372e90b6f03a608e77f2d940e384edb.lock
2025-06-13 21:52:11,301 - DEBUG - _api.py:254 - Attempting to acquire lock 127520264747920 on /ceph/ssd/students/hifl/hf_cache/datasets/gonglinyuan___safim/block/0.0.0/be132cc15372e90b6f03a608e77f2d940e384edb_builder.lock
2025-06-13 21:52:11,302 - DEBUG - _api.py:257 - Lock 127520264747920 acquired on /ceph/ssd/students/hifl/hf_cache/datasets/gonglinyuan___safim/block/0.0.0/be132cc15372e90b6f03a608e77f2d940e384edb_builder.lock
2025-06-13 21:52:11,302 - DEBUG - local.py:298 - open file: /ceph/ssd/students/hifl/hf_cache/datasets/gonglinyuan___safim/block/0.0.0/be132cc15372e90b6f03a608e77f2d940e384edb/dataset_info.json
2025-06-13 21:52:11,303 - DEBUG - _api.py:286 - Attempting to release lock 127520264747920 on /ceph/ssd/students/hifl/hf_cache/datasets/gonglinyuan___safim/block/0.0.0/be132cc15372e90b6f03a608e77f2d940e384edb_builder.lock
2025-06-13 21:52:11,304 - DEBUG - _api.py:289 - Lock 127520264747920 released on /ceph/ssd/students/hifl/hf_cache/datasets/gonglinyuan___safim/block/0.0.0/be132cc15372e90b6f03a608e77f2d940e384edb_builder.lock
2025-06-13 21:52:12,067 - INFO - backup_safim2.py:520 - Using completion type: block
2025-06-13 21:52:12,074 - INFO - backup_safim2.py:525 - Filtered to 805 Python samples
2025-06-13 21:52:12,247 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000523: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,262 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000541: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,267 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000542: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,274 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000543: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,280 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000544: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,287 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000545: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,294 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000546: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,301 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000547: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,308 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000548: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,313 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000724: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,316 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000725: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,320 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000726: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,323 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000727: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,327 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000728: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,331 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000729: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,334 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000730: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,339 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000731: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,343 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000732: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,347 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000733: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,352 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000734: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,357 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000735: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,362 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000736: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,367 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000737: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,372 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000738: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,376 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000739: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,381 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000796: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,386 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000797: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,391 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000798: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,396 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000799: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,402 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000800: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,408 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000801: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,413 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000802: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,420 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000803: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,425 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000804: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,430 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000805: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,435 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000806: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,440 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000807: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,446 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000808: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,452 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000809: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,458 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000810: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,462 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000845: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,616 - INFO - backup_safim2.py:599 - Saved cache at sample 100
2025-06-13 21:52:12,621 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000846: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,626 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000847: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,631 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000848: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,636 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000849: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,641 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000850: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,646 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000851: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,650 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000852: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,656 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000853: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,661 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000854: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,667 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000855: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,672 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000856: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,678 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000880: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,686 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000881: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,692 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000882: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,697 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000883: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,701 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000884: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,705 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000885: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,710 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000886: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,714 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000887: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,718 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000888: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,723 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000889: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,726 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000890: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,731 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000891: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,735 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000892: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,739 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000893: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,743 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000894: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,747 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000895: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,754 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000923: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,759 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000924: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,764 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000925: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,769 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000926: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,775 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000927: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,780 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000928: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,784 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000929: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,789 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000930: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,794 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000931: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,798 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000974: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,802 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000975: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,806 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000976: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,810 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000977: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,813 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000978: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,816 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000979: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,820 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000980: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,823 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000981: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,827 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000982: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,830 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000983: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,834 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000984: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,838 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000985: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,841 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000986: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:12,845 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_000987: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,013 - INFO - backup_safim2.py:599 - Saved cache at sample 150
2025-06-13 21:52:13,019 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001016: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,026 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001017: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,032 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001018: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,038 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001019: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,044 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001020: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,051 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001021: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,057 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001022: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,064 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001023: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,070 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001024: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,076 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001025: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,083 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001026: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,091 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001049: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,096 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001050: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,101 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001073: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,105 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001094: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,110 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001095: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,116 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001104: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,122 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001105: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,127 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001106: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,132 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001116: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,137 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001117: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,143 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001118: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,147 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001149: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,152 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001150: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,157 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001151: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,162 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001152: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,167 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001153: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,171 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001154: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,174 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001164: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,179 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001208: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,184 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001209: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,189 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001210: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,194 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001211: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,199 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001212: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,205 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001213: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,211 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001214: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,217 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001215: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,223 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001216: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,229 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001217: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,236 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001218: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,241 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001246: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,247 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001288: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,251 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001335: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,258 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001449: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:13,264 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001450: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:13,267 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001684: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,271 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001702: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,274 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001703: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,278 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001704: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,282 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001705: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,440 - INFO - backup_safim2.py:599 - Saved cache at sample 200
2025-06-13 21:52:13,445 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001706: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,451 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001707: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,457 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001708: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,463 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001709: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,468 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001710: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,475 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001804: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,483 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001805: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,493 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001806: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,501 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001807: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,509 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001808: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,517 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001809: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,525 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001810: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,530 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001811: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,534 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001826: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,538 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001827: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,542 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001828: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,545 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001829: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,549 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001830: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,553 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001831: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,557 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001832: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,561 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001833: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,565 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001834: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,570 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001835: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,574 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001836: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,578 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001837: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,583 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001838: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,587 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001839: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,592 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001918: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,597 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001919: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,601 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001920: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,606 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001921: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,613 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001953: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,620 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_001954: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:13,624 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002035: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,629 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002036: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,633 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002068: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,637 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002116: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,641 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002117: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,645 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002155: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,648 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002156: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,652 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002157: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,656 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002158: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,660 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002159: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,666 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002160: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,672 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002161: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,676 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002162: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,680 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002163: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,686 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002199: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,690 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002200: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,696 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002201: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,853 - INFO - backup_safim2.py:599 - Saved cache at sample 250
2025-06-13 21:52:13,861 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002202: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,870 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002203: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,877 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002204: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,884 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002255: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,892 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002256: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,899 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002257: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,906 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002258: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,912 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002259: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,919 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002260: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,923 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002261: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,928 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002262: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,934 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002280: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,939 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002281: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,945 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002282: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,951 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002283: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,957 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002284: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,962 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002285: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,967 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002286: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,973 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002287: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,979 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002288: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,984 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002289: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,988 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002395: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,993 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002396: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:13,997 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002397: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,001 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002398: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,005 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002399: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,009 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002400: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,013 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002401: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,018 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002402: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,023 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002403: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,027 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002404: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,031 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002405: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,037 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002482: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,044 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002483: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,050 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002489: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,055 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002490: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,060 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002514: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,065 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002515: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,070 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002516: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,074 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002517: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,079 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002518: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,083 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002519: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,087 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002537: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,092 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002625: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,097 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002627: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,102 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002628: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,107 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002629: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,113 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002630: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,119 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002631: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,124 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002632: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,280 - INFO - backup_safim2.py:599 - Saved cache at sample 300
2025-06-13 21:52:14,288 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002633: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,295 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002696: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,301 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002697: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,307 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002698: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,313 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002714: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,319 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002715: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,326 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002743: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,333 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002744: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,341 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002756: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,349 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002786: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,355 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002787: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,359 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002941: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,372 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002942: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,377 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002943: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,381 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002944: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,385 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002945: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,390 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002946: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,394 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002947: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,398 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002948: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,402 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002949: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,407 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002950: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,412 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002951: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,420 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002989: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,426 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002990: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,431 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002991: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,438 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002992: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,443 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002993: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,448 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002994: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,453 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002995: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,457 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002996: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,462 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002997: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,466 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002998: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,471 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_002999: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,476 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003000: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,480 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003038: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,485 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003039: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,489 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003040: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,494 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003041: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,499 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003042: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,505 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003160: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,510 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003161: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,515 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003162: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,520 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003163: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,526 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003164: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,531 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003165: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,535 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003169: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,539 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003170: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,544 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003171: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,549 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003207: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,554 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003208: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,716 - INFO - backup_safim2.py:599 - Saved cache at sample 350
2025-06-13 21:52:14,723 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003209: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,731 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003210: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,736 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003352: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,741 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003353: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,746 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003354: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,752 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003355: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,757 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003356: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,767 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003393: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:14,780 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003394: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:14,787 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003415: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,795 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003416: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,800 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003417: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,804 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003418: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,808 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003419: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,812 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003420: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,816 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003421: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,819 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003422: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,823 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003423: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,827 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003424: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,831 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003425: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,835 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003426: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,840 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003443: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,844 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003444: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,849 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003445: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,853 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003446: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,858 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003447: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,862 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003448: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,867 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003449: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,872 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003450: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,876 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003461: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,880 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003462: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,885 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003463: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,890 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003581: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,894 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003582: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,898 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003583: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,902 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003584: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,906 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003585: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,910 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003586: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,915 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003651: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,919 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003652: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,925 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003673: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,930 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003674: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,934 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003722: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,938 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003723: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,942 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003724: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,946 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003725: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,950 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003726: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,954 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003727: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,959 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003728: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:14,965 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003729: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,122 - INFO - backup_safim2.py:599 - Saved cache at sample 400
2025-06-13 21:52:15,128 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003730: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,136 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003746: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,149 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003747: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,159 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003753: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,169 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003754: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,176 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003755: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,183 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003765: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,191 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003766: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,198 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003767: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,204 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003768: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,209 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003769: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,215 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003791: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,220 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003792: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,225 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003931: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,230 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_003932: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,235 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004085: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,240 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004147: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,245 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004148: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,249 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004172: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,255 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004173: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,259 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004197: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,263 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004198: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,267 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004199: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,271 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004200: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,275 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004201: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,278 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004202: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,282 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004203: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,286 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004204: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,290 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004205: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,296 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004255: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,302 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004256: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,306 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004257: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,311 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004258: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,315 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004259: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,321 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004263: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,328 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004264: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,333 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004265: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,338 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004266: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,343 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004267: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,348 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004268: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,353 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004269: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,357 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004270: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,361 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004271: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,365 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004272: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,372 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004307: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,379 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004308: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,387 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004309: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,394 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004310: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,401 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004311: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,408 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004312: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,565 - INFO - backup_safim2.py:599 - Saved cache at sample 450
2025-06-13 21:52:15,572 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004377: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,580 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004378: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,586 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004395: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,594 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004396: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,600 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004397: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,607 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004398: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,613 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004399: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,619 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004400: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,625 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004401: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,631 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004402: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,635 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004403: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,639 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004404: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,643 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004419: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,647 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004420: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,651 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004421: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,655 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004422: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,659 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004423: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,663 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004424: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,667 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004425: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,671 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004426: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,675 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004427: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,680 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004428: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,684 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004429: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,688 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004455: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,691 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004456: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,695 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004457: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,699 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004458: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,703 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004459: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,707 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004460: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,710 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004461: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,714 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004462: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,718 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004630: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,723 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004724: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,728 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004725: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,733 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004726: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,738 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004727: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,743 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004728: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,748 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004729: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,753 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004730: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,758 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004745: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,763 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004746: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,766 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004780: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,770 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004781: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,774 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004782: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,778 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004783: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,782 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004784: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,785 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004785: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,789 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004786: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,793 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004787: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,797 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004788: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,953 - INFO - backup_safim2.py:599 - Saved cache at sample 500
2025-06-13 21:52:15,960 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004801: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,967 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004802: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,974 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004803: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,981 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004804: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,988 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004805: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:15,994 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004806: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,000 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004807: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,006 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004808: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,014 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_004850: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,021 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005082: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,027 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005083: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,036 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005215: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,043 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005216: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,051 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005217: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:16,060 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005218: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:16,064 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005312: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,069 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005313: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,074 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005314: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,078 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005315: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,083 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005316: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,087 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005317: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,091 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005318: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,096 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005319: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,100 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005320: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,105 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005321: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,109 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005384: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,113 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005385: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,117 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005386: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,120 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005387: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,124 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005388: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,128 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005389: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,134 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005534: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,141 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005535: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,147 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005536: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,153 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005537: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,159 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005538: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,166 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005549: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,172 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005550: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:16,177 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005571: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,181 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005572: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,187 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005573: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,192 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005574: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,197 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005575: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,203 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005576: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,209 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005577: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,214 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005578: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,219 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005579: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,226 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005580: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,232 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005581: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,242 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005582: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,399 - INFO - backup_safim2.py:599 - Saved cache at sample 550
2025-06-13 21:52:16,408 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005583: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,416 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005606: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,428 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005607: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,437 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005608: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,444 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005609: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,450 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005610: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,457 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005611: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,463 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005612: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,469 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005613: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,474 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005614: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,480 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005667: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,486 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005668: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,491 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005669: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,496 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005670: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,503 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005671: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,508 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005672: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,511 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005800: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,515 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005801: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,519 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005802: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,522 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005803: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,526 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005804: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,530 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005805: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,533 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005806: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,537 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005807: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,540 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005808: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,543 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005809: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,546 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005810: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,550 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005811: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,553 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005812: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,559 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005866: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,567 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005931: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:16,574 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005932: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:16,582 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005933: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:16,591 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005934: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:16,600 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005935: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:16,611 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005936: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:16,615 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005986: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,620 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_005987: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,625 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006024: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,631 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006025: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,636 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006026: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,642 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006027: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,647 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006028: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,652 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006029: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,658 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006030: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,664 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006031: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,669 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006032: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,674 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006045: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,679 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006063: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,684 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006064: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,836 - INFO - backup_safim2.py:599 - Saved cache at sample 600
2025-06-13 21:52:16,844 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006065: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,852 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006066: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,858 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006086: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,864 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006087: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,871 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006088: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,877 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006089: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,882 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006090: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,888 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006091: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,895 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006092: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,900 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006093: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,906 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006094: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,910 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006095: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,913 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006096: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,917 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006097: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,924 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006115: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,931 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006116: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,936 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006450: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,942 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006456: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,948 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006457: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,954 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006707: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,960 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006708: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,966 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006772: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,974 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006773: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,980 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006955: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,985 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006956: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,988 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006957: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,992 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006958: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:16,996 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006959: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,000 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006994: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,004 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_006995: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,011 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007029: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,017 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007030: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:17,023 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007066: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,028 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007067: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,033 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007068: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,038 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007069: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,042 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007166: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,047 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007167: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,052 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007322: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,057 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007437: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,062 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007438: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,067 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007439: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,072 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007440: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,077 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007441: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,081 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007442: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,085 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007443: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,092 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007521: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:17,099 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007522: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:17,102 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007619: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,106 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007620: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,265 - INFO - backup_safim2.py:599 - Saved cache at sample 650
2025-06-13 21:52:17,270 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007621: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,275 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007622: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,280 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007623: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,285 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007624: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,291 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007625: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,297 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007626: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,302 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007627: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,307 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007628: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,313 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007687: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,319 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007688: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,326 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007689: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,332 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007690: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,338 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007691: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,345 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007692: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,351 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007693: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,355 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007694: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,359 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007695: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,363 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007696: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,367 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007697: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,370 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007698: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,374 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007699: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,378 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007700: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,382 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007701: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,386 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007702: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,391 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007861: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,395 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007862: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,399 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007863: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,404 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007864: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,409 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007865: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,414 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007866: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,418 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007867: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,422 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007868: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,426 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007869: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,431 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007870: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,435 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007871: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,440 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007888: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,445 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007889: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,450 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007890: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,455 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007891: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,460 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007892: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,465 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007893: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,470 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007894: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,475 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007895: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,480 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007896: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,485 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007904: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,489 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007905: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,494 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007906: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,500 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007907: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,505 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007908: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,510 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007909: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,679 - INFO - backup_safim2.py:599 - Saved cache at sample 700
2025-06-13 21:52:17,686 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007910: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,693 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007911: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,700 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007912: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,708 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_007913: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,717 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008013: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,727 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008014: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,734 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008015: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,741 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008016: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,746 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008033: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,752 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008034: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,758 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008035: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,765 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008069: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,771 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008070: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,776 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008093: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,781 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008094: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,786 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008095: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,791 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008096: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,795 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008097: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,800 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008098: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,805 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008119: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,809 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008120: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,813 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008121: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,817 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008122: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,821 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008123: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,825 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008124: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,829 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008125: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,834 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008126: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,838 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008127: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,843 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008128: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,847 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008165: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,851 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008166: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,854 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008167: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,859 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008168: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,864 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008169: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,868 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008170: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,872 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008171: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,876 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008172: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,879 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008173: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,883 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008174: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,888 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008175: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,893 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008176: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,899 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008218: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,905 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008219: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,909 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008220: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,913 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008221: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,918 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008222: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,923 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008223: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,928 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008224: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,932 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008225: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:17,937 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008226: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,098 - INFO - backup_safim2.py:599 - Saved cache at sample 750
2025-06-13 21:52:18,105 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008286: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,113 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008287: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,121 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008315: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,128 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008316: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,136 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008317: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,144 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008392: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,152 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008393: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,160 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008394: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,167 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008470: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,172 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008471: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,178 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008584: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,183 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008585: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,187 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008602: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,194 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008645: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:18,200 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008646: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:18,206 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008647: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:18,212 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008648: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:18,219 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008664: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:18,226 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008665: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2453, in generate
    self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 1617, in _validate_generated_length
    raise ValueError(
ValueError: Input length of input_ids is 2048, but `max_length` is set to 2048. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
2025-06-13 21:52:18,231 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008687: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,236 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008688: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,241 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008689: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,246 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008690: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,251 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008691: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,256 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008692: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,262 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008693: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,268 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008694: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,273 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008695: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,277 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008696: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,281 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008709: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,284 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008710: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,288 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008711: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,292 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008712: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,296 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008713: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,299 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008714: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,303 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008715: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,306 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008716: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,310 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008717: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,315 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008718: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,320 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008746: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,324 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008747: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,329 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008748: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,333 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008749: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,337 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008750: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,342 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008751: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,346 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008752: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,351 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008753: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,356 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008766: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,361 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008767: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,367 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008768: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,525 - INFO - backup_safim2.py:599 - Saved cache at sample 800
2025-06-13 21:52:18,535 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008769: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,543 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008770: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,550 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008771: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,559 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008772: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,568 - ERROR - backup_safim2.py:397 - Error during evaluation for block_completion_008773: 'GPT2CustomModel' object has no attribute '_attn_implementation'
Traceback (most recent call last):
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/backup_safim2.py", line 314, in evaluate_with_adversarial_attack
    raw_completion = model.invoke_cached(prompt, cache)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 18, in invoke_cached
    cache[prompt] = self.invoke(prompt)
                    ^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/Masterarbeit/pythonProject7/Python_Files/safim/model_utils.py", line 535, in invoke
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 2597, in generate
    result = self._sample(
             ^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/generation/utils.py", line 3557, in _sample
    outputs = self(**model_inputs, return_dict=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1210, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 881, in forward
    _use_sdpa = self._attn_implementation == "sdpa" and output_attentions is False and head_mask is None
                ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/homedirs/hifl/miniconda3/envs/safim_clean_env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'GPT2CustomModel' object has no attribute '_attn_implementation'
2025-06-13 21:52:18,748 - INFO - backup_safim2.py:603 - Final cache saved with 3875 entries.
2025-06-13 21:52:18,761 - INFO - backup_safim2.py:608 - Results saved to: ./safim_outputs/Results/bigcode_santacoder.jsonl
2025-06-13 21:52:18,761 - INFO - backup_safim2.py:610 - 
============================================================
2025-06-13 21:52:18,762 - INFO - backup_safim2.py:611 - Results Summary:
2025-06-13 21:52:18,762 - INFO - backup_safim2.py:612 - ============================================================
2025-06-13 21:52:18,762 - INFO - backup_safim2.py:613 - Total samples processed: 746
2025-06-13 21:52:18,762 - INFO - backup_safim2.py:614 - Samples with major evaluation errors (aborted eval for sample): 746
2025-06-13 21:52:18,762 - INFO - backup_safim2.py:617 - 
--- Original Completion Performance (on 0 evaluable samples) ---
2025-06-13 21:52:18,762 - INFO - backup_safim2.py:621 - Passed (original prompt): 0 (N/A)
2025-06-13 21:52:18,762 - INFO - backup_safim2.py:627 - 
--- Adversarial Attack Results ---
2025-06-13 21:52:18,762 - INFO - backup_safim2.py:629 - Samples eligible for adversarial attack (original passed tests): 0
2025-06-13 21:52:18,762 - INFO - backup_safim2.py:631 -   Vulnerable (attack succeeded): 0
2025-06-13 21:52:18,762 - INFO - backup_safim2.py:632 -   Robust (attack attempted, no adversarial effect found): 0
2025-06-13 21:52:18,762 - INFO - backup_safim2.py:633 -   Attack Setup Failed (placeholder/reordering issues prevented test): 0
2025-06-13 21:52:18,762 - INFO - backup_safim2.py:640 -   Vulnerability Rate (among successfully setup and tested attacks): N/A (no attacks successfully set up and tested)
2025-06-13 21:52:18,762 - INFO - backup_safim2.py:641 -   Robustness Rate (among successfully setup and tested attacks): N/A (no attacks successfully set up and tested)
2025-06-13 21:52:18,762 - INFO - backup_safim2.py:643 - Adversarial attack skipped because original completion failed: 0
2025-06-13 21:52:18,763 - INFO - backup_safim2.py:650 - Adversarial attack skipped for other reasons on original passes (e.g., manual, no GT/tests): 0
2025-06-13 21:52:18,763 - INFO - backup_safim2.py:651 -     Specifically: Manually skipped: 0
2025-06-13 21:52:18,763 - INFO - backup_safim2.py:652 -     Specifically: Skipped due to no GT/tests: 0
2025-06-13 21:52:18,763 - INFO - backup_safim2.py:653 -     Specifically: Not applicable (non-Python/no tests): 0
2025-06-13 21:52:18,768 - INFO - backup_safim2.py:710 - Summary saved to: ./safim_outputs/Summary/bigcode_santacoder_summary.txt
2025-06-13 21:52:18,768 - INFO - backup_safim2.py:712 - 
Log saved to: ./safim_outputs/Log/bigcode_santacoder.log
2025-06-13 21:53:23,242 - DEBUG - _api.py:286 - Attempting to release lock 127520284325200 on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/358772c6256487ed5b828fd3028f28ed5666075dcbf5afd9a200697a25be1dec.lock
2025-06-13 21:53:23,243 - DEBUG - _api.py:289 - Lock 127520284325200 released on /ceph/ssd/students/hifl/hf_cache/hub/.locks/models--bigcode--santacoder/358772c6256487ed5b828fd3028f28ed5666075dcbf5afd9a200697a25be1dec.lock
